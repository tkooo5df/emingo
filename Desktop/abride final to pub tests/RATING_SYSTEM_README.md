# نظام التقييم في تطبيق Abridas

## الميزات المضافة

### 1. تقييم الرحلات المكتملة
- يظهر قسم التقييم تلقائياً بعد إكمال الرحلة
- يتم عرض التقييم فقط للركاب في حجوزاتهم المكتملة
- لا يظهر التقييم للسائقين أو الرحلات غير المكتملة

### 2. واجهة التقييم
- **تقييم بالنجوم**: من 1 إلى 5 نجوم
- **تعليق اختياري**: يمكن للراكب كتابة تعليق حول تجربته
- **حفظ تلقائي**: يتم حفظ التقييم في قاعدة البيانات و localStorage
- **إمكانية التعديل**: يمكن للراكب تعديل تقييمه في أي وقت

### 3. كيفية الاستخدام

#### للراكب:
1. انتقل إلى "حجوزاتي" في لوحة التحكم
2. ابحث عن الرحلة المكتملة
3. ستجد قسم "تقييم الرحلة" أسفل تفاصيل الحجز
4. اختر عدد النجوم (من 1 إلى 5)
5. اكتب تعليقك (اختياري)
6. اضغط "حفظ التقييم"

#### لتعديل التقييم:
1. اضغط على "تعديل التقييم" في قسم التقييم
2. غيّر النجوم أو التعليق
3. اضغط "حفظ التقييم" أو "إلغاء" للتراجع

### 4. تخزين البيانات

التقييمات يتم حفظها في مكانين:

1. **قاعدة البيانات Supabase**: 
   - يتم إضافة التقييم إلى حقل `notes` في جدول `bookings`
   - الصيغة: "تقييم: X/5 - التعليق"

2. **LocalStorage**: 
   - مفتاح التخزين: `booking_ratings_{bookingId}`
   - يحتوي على: التقييم، التعليق، التاريخ، معرف السائق

### 5. المكونات المضافة

#### RatingSection Component
**الموقع**: `src/components/booking/RatingSection.tsx`

**الخصائص (Props)**:
- `bookingId`: معرف الحجز
- `driverId`: معرف السائق
- `driverName`: اسم السائق (اختياري)
- `existingRating`: التقييم الموجود (اختياري)
- `existingComment`: التعليق الموجود (اختياري)
- `onRatingSubmit`: دالة يتم استدعاؤها بعد حفظ التقييم

### 6. التحديثات في UserDashboard
- تم إضافة استيراد `RatingSection`
- تم إضافة قسم التقييم في عرض الحجوزات
- يظهر فقط عندما: `userProfile?.role === 'passenger' && booking.status === "completed"`

### 7. الميزات المستقبلية المقترحة

1. **عرض متوسط التقييمات للسائق**
2. **جدول منفصل للتقييمات** في قاعدة البيانات
3. **إحصائيات التقييمات** في لوحة تحكم السائق
4. **تصفية الرحلات** حسب التقييم
5. **إشعارات** للسائق عند استلام تقييم جديد

## التثبيت والاستخدام

النظام جاهز للاستخدام فوراً! لا يتطلب أي إعدادات إضافية.

## ملاحظات
- التقييمات محفوظة بشكل آمن
- يمكن للراكب فقط تقييم رحلاته
- التقييم يظهر مباشرة بعد إكمال الرحلة

