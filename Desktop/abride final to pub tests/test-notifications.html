<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅุดุนุงุฑุงุช</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .notification {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>๐ ุงุฎุชุจุงุฑ ูุธุงู ุงูุฅุดุนุงุฑุงุช</h1>
        
        <div class="test-section">
            <h3>1. ุงุฎุชุจุงุฑ ุฅูุดุงุก ุฅุดุนุงุฑ</h3>
            <button onclick="testCreateNotification()">ุฅูุดุงุก ุฅุดุนุงุฑ ุชุฌุฑูุจู</button>
            <div id="createResult"></div>
        </div>

        <div class="test-section">
            <h3>2. ุงุฎุชุจุงุฑ ุฅุดุนุงุฑุงุช ุงูุญุฌุฒ</h3>
            <button onclick="testBookingNotification()">ุฅุดุนุงุฑ ุญุฌุฒ ุฌุฏูุฏ</button>
            <button onclick="testBookingConfirmed()">ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ</button>
            <button onclick="testBookingCancelled()">ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ</button>
            <div id="bookingResult"></div>
        </div>

        <div class="test-section">
            <h3>3. ุงุฎุชุจุงุฑ ุฌูุจ ุงูุฅุดุนุงุฑุงุช</h3>
            <button onclick="testGetNotifications()">ุฌูุจ ุงูุฅุดุนุงุฑุงุช</button>
            <button onclick="testGetStats()">ุฌูุจ ุงูุฅุญุตุงุฆูุงุช</button>
            <div id="getResult"></div>
        </div>

        <div class="test-section">
            <h3>4. ุณุฌู ุงูุนูููุงุช</h3>
            <button onclick="clearLog()">ูุณุญ ุงูุณุฌู</button>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        let logElement = document.getElementById('log');
        
        function log(message) {
            const timestamp = new Date().toLocaleString('ar-SA');
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function clearLog() {
            logElement.textContent = '';
        }

        function showResult(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="${isError ? 'error' : 'success'}">${message}</div>`;
        }

        async function testCreateNotification() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฅูุดุงุก ุฅุดุนุงุฑ...');
                
                const response = await fetch('/api/test-notification', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userId: 'test-user-1',
                        title: 'ุฅุดุนุงุฑ ุชุฌุฑูุจู',
                        message: 'ูุฐุง ุฅุดุนุงุฑ ุชุฌุฑูุจู ูุงุฎุชุจุงุฑ ุงููุธุงู',
                        type: 'info',
                        category: 'system',
                        priority: 'medium'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฅูุดุงุก ุงูุฅุดุนุงุฑ ุจูุฌุงุญ: ' + result.id);
                    showResult('createResult', 'ุชู ุฅูุดุงุก ุงูุฅุดุนุงุฑ ุจูุฌุงุญ!');
                } else {
                    throw new Error('ูุดู ูู ุฅูุดุงุก ุงูุฅุดุนุงุฑ');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุฅุดุนุงุฑ: ' + error.message);
                showResult('createResult', 'ุฎุทุฃ ูู ุฅูุดุงุก ุงูุฅุดุนุงุฑ: ' + error.message, true);
            }
        }

        async function testBookingNotification() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ุงูุญุฌุฒ...');
                
                const response = await fetch('/api/test-booking-notification', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        bookingId: 'test-booking-1',
                        passengerId: 'test-passenger-1',
                        driverId: 'test-driver-1',
                        tripId: 'test-trip-1',
                        pickupLocation: 'ุงูุฌุฒุงุฆุฑ ุงูุนุงุตูุฉ',
                        destinationLocation: 'ููุฑุงู',
                        seatsBooked: 2,
                        totalAmount: 1500,
                        paymentMethod: 'cod'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุงูุญุฌุฒ ุจูุฌุงุญ: ' + result.length + ' ุฅุดุนุงุฑ');
                    showResult('bookingResult', 'ุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุงูุญุฌุฒ ุจูุฌุงุญ!');
                } else {
                    throw new Error('ูุดู ูู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุงูุญุฌุฒ');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฅุดุนุงุฑ ุงูุญุฌุฒ: ' + error.message);
                showResult('bookingResult', 'ุฎุทุฃ ูู ุฅุดุนุงุฑ ุงูุญุฌุฒ: ' + error.message, true);
            }
        }

        async function testBookingConfirmed() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ...');
                
                const response = await fetch('/api/test-booking-confirmed', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        bookingId: 'test-booking-1',
                        driverId: 'test-driver-1'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ ุจูุฌุงุญ');
                    showResult('bookingResult', 'ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ ุจูุฌุงุญ!');
                } else {
                    throw new Error('ูุดู ูู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ: ' + error.message);
                showResult('bookingResult', 'ุฎุทุฃ ูู ุฅุดุนุงุฑ ุชุฃููุฏ ุงูุญุฌุฒ: ' + error.message, true);
            }
        }

        async function testBookingCancelled() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ...');
                
                const response = await fetch('/api/test-booking-cancelled', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        bookingId: 'test-booking-1',
                        actorId: 'test-passenger-1',
                        reason: 'ุชุบููุฑ ูู ุงูุฎุทุท'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ ุจูุฌุงุญ');
                    showResult('bookingResult', 'ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ ุจูุฌุงุญ!');
                } else {
                    throw new Error('ูุดู ูู ุฅุฑุณุงู ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ: ' + error.message);
                showResult('bookingResult', 'ุฎุทุฃ ูู ุฅุดุนุงุฑ ุฅูุบุงุก ุงูุญุฌุฒ: ' + error.message, true);
            }
        }

        async function testGetNotifications() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฌูุจ ุงูุฅุดุนุงุฑุงุช...');
                
                const response = await fetch('/api/test-get-notifications?userId=test-user-1');
                
                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฌูุจ ุงูุฅุดุนุงุฑุงุช ุจูุฌุงุญ: ' + result.length + ' ุฅุดุนุงุฑ');
                    showResult('getResult', `ุชู ุฌูุจ ${result.length} ุฅุดุนุงุฑ ุจูุฌุงุญ!`);
                } else {
                    throw new Error('ูุดู ูู ุฌูุจ ุงูุฅุดุนุงุฑุงุช');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฌูุจ ุงูุฅุดุนุงุฑุงุช: ' + error.message);
                showResult('getResult', 'ุฎุทุฃ ูู ุฌูุจ ุงูุฅุดุนุงุฑุงุช: ' + error.message, true);
            }
        }

        async function testGetStats() {
            try {
                log('ุจุฏุก ุงุฎุชุจุงุฑ ุฌูุจ ุงูุฅุญุตุงุฆูุงุช...');
                
                const response = await fetch('/api/test-get-stats?userId=test-user-1');
                
                if (response.ok) {
                    const result = await response.json();
                    log('โ ุชู ุฌูุจ ุงูุฅุญุตุงุฆูุงุช ุจูุฌุงุญ: ' + JSON.stringify(result));
                    showResult('getResult', `ุงูุฅุญุตุงุฆูุงุช: ${result.total} ุฅุฌูุงููุ ${result.unread} ุบูุฑ ููุฑูุก`);
                } else {
                    throw new Error('ูุดู ูู ุฌูุจ ุงูุฅุญุตุงุฆูุงุช');
                }
            } catch (error) {
                log('โ ุฎุทุฃ ูู ุฌูุจ ุงูุฅุญุตุงุฆูุงุช: ' + error.message);
                showResult('getResult', 'ุฎุทุฃ ูู ุฌูุจ ุงูุฅุญุตุงุฆูุงุช: ' + error.message, true);
            }
        }

        // ุจุฏุก ุงูุงุฎุชุจุงุฑุงุช ุงูุชููุงุฆูุฉ
        window.onload = function() {
            log('๐ ุชู ุชุญููู ุตูุญุฉ ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช');
            log('ููููู ุงูุขู ุงุฎุชุจุงุฑ ุงููุธุงู ุจุงุณุชุฎุฏุงู ุงูุฃุฒุฑุงุฑ ุฃุนูุงู');
        };
    </script>
</body>
</html>
